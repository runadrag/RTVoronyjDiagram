<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print" />
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <title>Voronyj Diagram in Roassal by runadrag</title>
  </head>

  <body>
    <div id="container">
      <div class="inner">

        <header>
          <h1>Voronyj Diagram in Roassal</h1>
          <h2>roassal, roassal2, voronoi, voronyj, visualisation, pharo</h2>
        </header>

        <section id="downloads" class="clearfix">
          <a href="https://ci.inria.fr/pharo-contribution/job/RTVoronyjDiagram/PHARO=30,VERSION=development,VM=vm/lastSuccessfulBuild/artifact/RTVoronyjDiagram.zip" id="download-zip" class="button"><span>Download image</span></a>
          <a href="http://smalltalkhub.com/#!/~NataliaTymchuk/RTVoronyjDiagram" id="download-tar-gz" class="button"><span>SmalltalkHub</span></a>
          <a href="https://github.com/runadrag/RTVoronyjDiagram/issues" id="view-on-github" class="button"><span>Issue tracker</span></a>
        </section>
        <hr>

        <section id="main_content">
          <p><a href="http://en.wikipedia.org/wiki/Voronoi_diagram">Voronyj (Voronoi) diagrams</a> are being used for more than 300 years in epidemiology, architecture, mining and machine learning. Now we not only provide the support for it in <a href="http://objectprofile.com/ObjectProfile.html">Roassal 2</a>, but also suggest an approach to visualize a software with voronyj diagrams.</p>

<p>To download this just choose one method from the nexts:</p>

<ol>
<li>download image from link above <a href="https://ci.inria.fr/pharo-contribution/job/RTVoronyjDiagram/PHARO=30,VERSION=development,VM=vm/">CI server</a>
</li>
<li>
<p>run this code in Pharo 3 image</p>

<pre><code>Gofer new
  smalltalkhubUser: 'NataliaTymchuk'
  project: 'RTVoronyjDiagram';
  configuration;
  load.
#ConfigurationOfRTVoronyjDiagram asClass loadDevelopment
</code></pre>
</li>
<li>
<p>download throught Monticello using the repository:</p>

<pre><code>MCSmalltalkhubRepository
  owner: 'NataliaTymchuk'
  project: 'RTVoronyjDiagram'
</code></pre>
</li>
</ol>
<p>If you want simple way how to use RTVoronyjBuilder,just run next code:</p>
<pre><code>| builder |
builder := RTVoronyjBuilder new .
builder objects: {
   10 @ 40 .  40 @ 10 .  10 @ -20 . -20 @ 10.
  -20 @ 60 . -30 @ 40 . 160 @ 90  . 100 @ -30 }.
builder positionBlock: #yourself.
builder open.
</code></pre>
<p>You will give you this image</p>
<img src="pub-images\SimpleVD.png" alt="Simple Voronyj diagram">
<p>It's nice but you can do it more informative and presentable.</p>

<p>First of all you can add the color of the cells.</p>
<ul>
<li>cell color:
  <pre><code>
builder color: Color blue.
  </code></pre>
  <ol>
  <p>As usual in Roassal you can use normalization of color, for example</p>
    <li>cell normalized color:
        <pre><code>
cn := RTNColorLinearNormalizer
  inContext: objects
  withCommand: #x
  lowColor: (Color r:0 g:0 b:1)
  highColor: (Color r:1 g:1 b:0).
builder color: cn.
  </code></pre>
</li>
<p>Now let's give more properties for the sites. The sites are built by RTSiteBuilder and can be eccessed by the message<code> site </code>.
  It uses ShapeBuilder, that's why you can use all the features of the ShapeBuilder. So you can add:</p>
    <li>site color:
      <pre><code>builder sites shape
  color: Color yellow.
</code></pre>
    </li>

    <li>site shape:
      <pre><code>builder sites shape rectangle.</code></pre>
    </li>

    <li>site size:
      <pre><code>builder sites shape
  size: 30.
      </code></pre>
    </li>

    <li>site interaction:
      <ol>
        <li>popup text:
          <pre><code>
builder sites interaction
	      popupText: [ :obj | 'I am', obj asString ].
          </code></pre>
        </li>
        <li>highlight color
          <pre><code>
builder sites interaction
	      highlightColored: Color red.
          </code></pre>
        </li>
      </ol>
      <p>Notice that for building sites we have another builder RTSiteBuilder, while cell properties is implemented in RTVoronyjBuilder. </p>

  </li>
</ul>
<p>Now using the code:</p>
<pre><code>
| builder cn objects |

objects := { 10 @ 40 . 40 @ 10 . 10 @ -20 . -20 @ 10.
            -20 @ 60 . -30 @ 40 . 160 @ 90 . 100 @ -30 }.

cn := RTNColorLinearNormalizer
inContext: objects
withCommand: #x
lowColor: (Color r:0 g:0 b:1)
highColor: (Color r:1 g:1 b:0).

 builder := RTVoronyjBuilder new .
 builder objects: objects.
 builder positionBlock: #yourself.
 builder color: cn.
 builder sites shape rectangle;
         color: Color green;
		     size: 10.
 builder sites interaction
	       popupText: [ :obj | 'I am', obj asString ];
         highlightColored: Color red.
 builder build.
 builder view
 @ RTZoomableView;
 open
</code></pre>
<p>you will get this image</p>
<img src="pub-images/NiceVD.png" alt="Nice Voronyj diagram with properties above">

<p> Let's talk where you can use it. </p>
<p> You may know about great project on Roassal called MapBuiler. You can build your map and than use RTVoronyjBuilder to draw Voronyj diagrams.
This way you can see for example which citi is closest to you or if you want to find small citi which is the closest for job.
You just need to add next lines of code:  </p>
<code><pre>
  | b v |
	b := RTMapBuilder new.

	b countries: RTMapBuilder southAmerica.
	b cities: #( " (name, population) pairs "
		#('Santiago')
		#('Bogota')
		#('Buenos Aires')
		#('Brasilia')
		#('Montevideo')
		#('Lima')
		#('La Paz')
		#('Quito')
		#('Sao Paulo')
		#('Caracas'))
		named: [ :c | c at: 1 ].

	b cities
		withPopup: [ :c | (c at: 1), ': ', (((c at: 2) / 1000000 roundTo: 0.01) asString), 'M'].

b color: Color veryVeryLightGray.
	b scale: 3.
	b withPopup.

	v := RTView new.
	b renderIn: v.

	RTVoronyjBuilder new
		objects: (v elements select:[:e | e shape class = RTEllipse ]);
		positionBlock: #position;
		doNotRenderSites;
		color: (Color black alpha: 0.05);
		renderIn: v.
v
</code></pre>
<p>It looks </p>
<img src="pub-images/VDMap.png" alt="Voronyj diagram on map">
        </section>

        <footer>
          Voronyj Diagram in Roassal is maintained by <a href="https://github.com/runadrag">runadrag</a><br>
          This page was generated by <a href="http://pages.github.com">GitHub Pages</a>. Tactile theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.
        </footer>


      </div>
    </div>
  </body>
</html>
