<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="keywords" content="roassal, roassal2, voronoi, voronyj, visualisation, pharo">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print" />
    <script src="http://code.jquery.com/jquery-2.1.1.min.js"></script>
    <script src="javascripts/main.js"></script>
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <title>Voronyj Diagram in Roassal by runadrag</title>
  </head>

  <body>
    <div id="container">
      <div class="inner">
        <a name="home"></a>
        <header>
          <h1>Voronyj Diagram in Roassal</h1>
          <h3>Get even more from visualization</h3>
        </header>

        <section id="downloads" class="clearfix">
          <a href="https://ci.inria.fr/pharo-contribution/job/RTVoronyjDiagram/PHARO=30,VERSION=development,VM=vm/lastSuccessfulBuild/artifact/RTVoronyjDiagram.zip" id="download-zip" class="button"><span>Download image</span></a>
          <a target="_blank" href="http://smalltalkhub.com/#!/~NataliaTymchuk/RTVoronyjDiagram" id="download-tar-gz" class="button"><span>SmalltalkHub</span></a>
          <a target="_blank" href="https://github.com/runadrag/RTVoronyjDiagram/issues" id="view-on-github" class="button"><span>Issue tracker</span></a>
        </section>
        <img src="images/splash.png" alt="Voronyj diagram">
        <hr>



  <div id="navWrap">
    <div id="nav">
        <ul>
            <li><a href="#home" class="smoothScroll">Home</a></li>
            <li><a href="#usage" class="smoothScroll">Usage</a></li>
            <li><a href="#customization" class="smoothScroll">Customization</a></li>
            <li><a href="#integration" class="smoothScroll">Integration</a></li>
            <li><a href="#futureWork" class="smoothScroll">Future Work</a></li>
        </ul>
    </div></div>





        <section id="main_content">

<!-- <a name="1"></a> -->
<p><h2>Quick introduction</h2></p>

<p><a target="_blank" href="http://en.wikipedia.org/wiki/Voronoi_diagram">Voronyj (Voronoi) diagrams</a> have been used for more than 300 years in epidemiology, architecture, mining and machine learning. Now we not only provide the support for it in <a target="_blank" href="http://objectprofile.com/ObjectProfile.html">Roassal 2</a>, but also suggest an approach to visualize a software with Voronyj diagrams.</p>


<h2>How to Download</h2>
<p>To download this just choose one method from the next options:</p>

<ol>
<li>download the image from the link above <a target="_blank"  href="https://ci.inria.fr/pharo-contribution/job/RTVoronyjDiagram/PHARO=30,VERSION=development,VM=vm/">CI server</a>
</li>
<li>
<p>run this code in Pharo 3 image</p>

<pre><code>Gofer new
  smalltalkhubUser: 'NataliaTymchuk'
  project: 'RTVoronyjDiagram';
  configuration;
  load.
#ConfigurationOfRTVoronyjDiagram asClass loadDevelopment
</code></pre>
</li>
<li>
<p>download thought Monticello using the repository:</p>

<pre><code>MCSmalltalkhubRepository
  owner: 'NataliaTymchuk'
project: 'RTVoronyjDiagram'
</code></pre>
</li>
</ol>

<a name="usage"></a>
<h2>How to Use</h2>

<p>A simple diagram needs the objects and block, which gives the position of the objects. For example you can do:</p>
<pre><code>| builder |
builder := RTVoronyjBuilder new .
builder objects: {
   10 @ 40 .  40 @ 10 .  10 @ -20 . -20 @ 10.
  -20 @ 60 . -30 @ 40 . 160 @ 90  . 100 @ -30 }.
builder positionBlock: #yourself.
builder open.
</code></pre>
<p>You will get this image
<img src="pub-images/SimpleVD.png" alt="Simple Voronyj diagram"></p>

<a name="customization"></a>
<h2>Customizing Diagram</h2>
<p>When we are looking on the previous image the question the question can turned up whether you can make the diagram more informative and interesting? Actually - yes. This builder provides a lot of properties to customize the diagram.</p>

<h3>Builder properties</h3>

<p>First of all you can work with the cells:</p>
<h4>Cell Color</h4>
  <pre><code>builder color: Color blue.</code></pre>
  <p>The builder allows you to do even more with the color. As usual in Roassal you can use normalization of the color, for example</p>

    <pre><code>cn := RTNColorLinearNormalizer
  inContext: objects
  withCommand: #x
  lowColor: (Color r:0 g:0 b:1)
  highColor: (Color r:1 g:1 b:0).
builder color: cn.</code></pre>

<h4>Frame</h4>
  <p>The builder uses the frame, which is bounding the cells. You can set the frame. For example </p>
  <pre><code>frameBlock: [ 0 @ 0 corner: 500 @ 500 ]</code></pre>
  <p>or</p>
  <pre><code>frameBlock: [view elements encompassingRectangle expandBy: 10 ]</code></pre>
  <p>Don't worry if it happens than your frame does not contain all the  points or object, it will be merged with   <code>minFrame</code>.</p>


<h3>Site properties</h3>
<p>The sites are built by <code>RTSiteBuilder</code> and can be accessed by the message <code>sites</code>.
  It uses <code>ShapeBuilder</code>, that's why you can use all the features of the ShapeBuilder. So you can add:</p>
<h4>Color</h4>
      <pre><code>builder sites shape
  color: Color yellow.</code></pre>

<h4>Shape</h4>
      <pre><code>builder sites shape rectangle.</code></pre>

<h4>Size</h4>
      <pre><code>builder sites shape
  size: 30.</code></pre>

<h4>Interaction</h4>
      <ol>
        <li>Popup text:
          <pre><code>builder sites interaction
  popupText: [ :obj | 'I am', obj asString ].</code></pre>
        </li>
        <li>Highlight color
          <pre><code>builder sites interaction
  highlightColored: Color red.</code></pre>
        </li>
      </ol>
      </li>
<p>Now let's see what we can get with using previous properties. Here is the code</p>
<pre><code>| builder cn objects |

objects := { 10 @ 40 . 40 @ 10 . 10 @ -20 . -20 @ 10.
            -20 @ 60 . -30 @ 40 . 160 @ 90 . 100 @ -30 }.

cn := RTNColorLinearNormalizer
  inContext: objects
  withCommand: #x
  lowColor: (Color r:0 g:0 b:1)
  highColor: (Color r:1 g:1 b:0).

builder := RTVoronyjBuilder new;
  objects: objects;
  positionBlock: #yourself;
  color: cn.
builder sites shape rectangle;
  color: Color green;
  size: 10.
builder sites interaction
  popupText: [ :obj | 'I am', obj asString ];
  highlightColored: Color red.
builder build.
builder view
 @ RTZoomableView;
 open</code></pre>
<p> which will give you this result</p>
<img src="pub-images/NiceVD.png" alt="Nice Voronyj diagram with properties above">


<a name="integration"></a>
<h2>Intergation with Other Builders</h2>

<p>You can use it for building the diagram with some point, as previous or you can use it with the other project.</p>

<h3>Diagram on Map</h3>
<p> You may know about great project on Roassal called MapBuiler. You can build your map and then use RTVoronyjBuilder to draw Voronyj diagrams.
This way you can see for example which city is closest to you or if you want to find small city which is the closest for job.
You just need to add a few lines of code:</p>
<pre><code>| builder view |
builder := RTMapBuilder new.
builder countries: RTMapBuilder southAmerica.
builder cities: #('Santiago' 'Bogota' 'Buenos Aires'
                  'Brasilia' 'Montevideo' 'Lima' 'La Paz'
                  'Quito' 'Sao Paulo' 'Caracas').

builder
  color: Color veryVeryLightGray;
  scale: 3;
  withPopup.

"next code is used to add Voronyj Diagram"

view := RTView new.
builder renderIn: view.

RTVoronyjBuilder new
  objects: (view elements select:[:e
                    | e shape class = RTEllipse ]);
  positionBlock: #position;
  doNotRenderSites;
  color: (Color black alpha: 0.05);
  renderIn: view.
view</code></pre>
<p>It looks </p>
<img src="pub-images/VDMap.png" alt="Voronyj diagram on map">

<a name="futureWork"></a>
<h2>Future Work</h2>
<p> I'm researching if it possible to analyze the software using Voronyj diagram. Like a lot of other things software artifacts don't have physical coordinates, however until now I already get such prototype: </p>
<img src="pub-images/ManyPoints.png" alt="Voronyj diagram with many entities">

        </section>

        <footer>
          Voronyj diagram in Roassal is maintained by <a href="http://natalia.tymchuk.me">Natalia Tymchuk</a><br>
          This page is based on Tactile theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.
        </footer>


      </div>
    </div>
  </body>
</html>
